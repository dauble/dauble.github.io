<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="UTF-8"/>
    <!-- <meta http-equiv="X-UA-Compatible" content="IE=edge"> -->
    <meta name="viewport" content="width=device-width,initial-scale=1.0, minimal-ui">
    <meta name="google-site-verification" content="mSvQDj528SrivJO3707MQV4uw5aUBxBXMfO9FTZz_sI" />
    <meta name="msvalidate.01" content="581C4BBEDA8127FA57A7F2B93320F97F" />

    <link rel="apple-touch-icon" sizes="57x57" href="/assets/images/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/images/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/images/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/images/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/images/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/images/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/images/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/images/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/assets/images/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/assets/images/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon-16x16.png">
    <link rel="manifest" href="/assets/images/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <title>Improving WordPress Search Results with Relevanssi</title>
    <link rel="stylesheet" href="/assets/css/styles.css?1614195008950277000" />

    <link type="application/atom+xml" rel="alternate" href="https://davidauble.com/feed.xml" title="Indianapolis Web Developer" />
    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Improving WordPress Search Results with Relevanssi | Indianapolis Web Developer</title>
<meta name="generator" content="Jekyll v4.0.1" />
<meta property="og:title" content="Improving WordPress Search Results with Relevanssi" />
<meta name="author" content="dauble" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I’ve been managing 17 WordPress sites for the past few years and one thing I’ve noticed is the default search built into WordPress isn’t flexible and doesn’t always return the most accurate results. I use Advanced Custom Fields heavily for each of the sites and have noticed the default search doesn’t search into these fields; it only searches titles and what’s in the page’s main content box. Since most of the pages on our sites don’t use those, I needed to find a better option." />
<meta property="og:description" content="I’ve been managing 17 WordPress sites for the past few years and one thing I’ve noticed is the default search built into WordPress isn’t flexible and doesn’t always return the most accurate results. I use Advanced Custom Fields heavily for each of the sites and have noticed the default search doesn’t search into these fields; it only searches titles and what’s in the page’s main content box. Since most of the pages on our sites don’t use those, I needed to find a better option." />
<link rel="canonical" href="https://davidauble.com/2019/03/05/improving-wordpress-search-results-with-relevanssi.html" />
<meta property="og:url" content="https://davidauble.com/2019/03/05/improving-wordpress-search-results-with-relevanssi.html" />
<meta property="og:site_name" content="Indianapolis Web Developer" />
<meta property="og:image" content="https://davidauble.com/assets/images/posts/relevanssi-search.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-03-05T00:00:00-05:00" />
<script type="application/ld+json">
{"datePublished":"2019-03-05T00:00:00-05:00","image":"https://davidauble.com/assets/images/posts/relevanssi-search.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://davidauble.com/2019/03/05/improving-wordpress-search-results-with-relevanssi.html"},"author":{"@type":"Person","name":"dauble"},"description":"I’ve been managing 17 WordPress sites for the past few years and one thing I’ve noticed is the default search built into WordPress isn’t flexible and doesn’t always return the most accurate results. I use Advanced Custom Fields heavily for each of the sites and have noticed the default search doesn’t search into these fields; it only searches titles and what’s in the page’s main content box. Since most of the pages on our sites don’t use those, I needed to find a better option.","@type":"BlogPosting","url":"https://davidauble.com/2019/03/05/improving-wordpress-search-results-with-relevanssi.html","headline":"Improving WordPress Search Results with Relevanssi","dateModified":"2019-03-05T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-16309361-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments)};
      gtag('js', new Date());

      gtag('config', 'UA-16309361-1');
    </script>
  </head>

  <body>
    <div id="page-top"></div>
    
  <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <div class="navbar-header page-scroll">

        <a class="navbar-brand page-scroll" href="/">
          <span class="logo"></span>
          <span class="logo-text">David M. Auble</span>
        </a>
      </div>

      <div class="collapse navbar-collapse navbar-ex1-collapse">
        <ul id="menu-primary" class="nav navbar-nav">
          <li class="menu-item"><a href="/#who-i-am">About</a></li>
          <li class="menu-item"><a href="/#services">Services</a></li>
          <li class="menu-item"><a href="/blog.html">Blog</a></li>
          <li class="menu-item"><a href="/#clients">Work</a></li>
          <li class="menu-item"><a href="/#twitter">Contact</a></li>
        </ul>
      </div>
    </div>
  </nav>


  <section class="hero interior">
    <div class="container-fluid">
      <div class="row no-gutter">
        <div class="col-xs-12">
          <div class="hero-background vb--home">
            <div class="hero-background__contain">
              <h1 class="hero-background__contain__title">Improving WordPress Search Results with Relevanssi</h1>
            </div>

            <div class="intro-banner js-parallax" style="background-image:url('/assets/images/posts/relevanssi-search.jpg')"></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="blog">
    <div class="container">
      <div class="row">
        <div class="col-sm-10 col-sm-offset-1">

          <article>
            <p>I’ve been managing 17 WordPress sites for the past few years and one thing I’ve noticed is the default search built into WordPress isn’t flexible and doesn’t always return the most accurate results. I use Advanced Custom Fields heavily for each of the sites and have noticed the default search doesn’t search into these fields; it only searches titles and what’s in the page’s main content box. Since most of the pages on our sites don’t use those, I needed to find a better option.</p>

<p>I looked into managed search solutions such as Algolia and Elasticsearch, but for my needs, those went above and beyond, not to mention were costly. I looked at other WordPress plugins, but since I use the Multisite feature on each site, almost none of the plugins were able to search across the WordPress network. Then I came across <a href="https://www.relevanssi.com/" target="_blank">Relevanssi</a>. Relevanssi offers two versions, free and paid, and promises to look into ACF fields and give more flexibility on searches. It allows me to add custom weights to titles, body fields, custom post types, add synonyms for related words, offers “Did you mean ___?” functionality and best of all, searches across a WordPress network.</p>

<p>After playing around with several settings, I was able to get the search results displaying nearly how I wanted. My two criteria were to have Pages appear above Posts, and to only display Posts newer than the previous two years. To do this though, I had to add some additional customization to my functions.php file. Luckily, the Relevanssi documentation is extremely helpful and detailed, plus the plugin author replies to each comment on support document pages.</p>

<p>Here’s what I ended up with in my functions.php file to display Pages above Posts, then return results newer than two years:</p>

<pre>
add_filter('relevanssi_hits_filter', 'products_first');
  function products_first($hits) {
    $types = array();

    $types['page'] = array();
    $types['post'] = array();

    // Split the post types in array $types
    if (!empty($hits)) {
      foreach ($hits[0] as $hit) {

        $date_cutoff = date('Y-m-d h:i:s', strtotime('-2 years'));
        if($hit-&gt;post_date &gt; $date_cutoff &amp;&amp; $hit-&gt;post_type == 'post') {
          array_push($types[$hit-&gt;post_type], $hit);
        }

        if($hit-&gt;post_type == 'page') {
          array_push($types[$hit-&gt;post_type], $hit);
        }
      }
    }

    // Merge back to $hits in the desired order
    $hits[0] = array_merge($types['page'], $types['post']);
    return $hits;
  }
</pre>

<p>I also noticed that sometimes, plural versions of words weren’t displaying properly either. Sometimes searching for “car” would return different results than “cars.” To get around this, I added a bit more code, found directly from the <a href="https://www.relevanssi.com/knowledge-base/simple-french-plurals/">documentation</a>:</p>

<pre>add_filter( 'relevanssi_stemmer', 'relevanssi_french_plural_stemmer' );
    function relevanssi_french_plural_stemmer( $term ) {
      $len  = strlen( $term );
      $end1 = substr( $term, -1, 1 );

      if ( 's' === $end1 &amp;&amp; $len &gt; 3 ) {
        $term = substr( $term, 0, -1 );
      } elseif ( 'x' === $end1 &amp;&amp; $len &gt; 3 ) {
        $term = substr( $term, 0, -1 );
      }

      return $term;
    }</pre>

<p>I couldn’t be happier with this plugin and hope it solves any problems you might have.</p>

          </article>

          <h3>Filed Under:</h3>
          <ul class="blog__categories">
            

            
              <li>
                <!-- <a href="///categories/#wordpress">wordpress</a> -->
                <span>wordpress</span>
              </li>
              &nbsp;
            
              <li>
                <!-- <a href="///categories/#relevanssi">relevanssi</a> -->
                <span>relevanssi</span>
              </li>
              
            
          </ul>

          <div class="view-archives">
            <a href="/blog.html" class="btn btn-secondary">View the archives</a>
          </div>
        </div>
      </div>
    </div>
  </section>

<footer>
  <div class="container">
    <div class="col-xs-12 col-sm-4 copyright">
      <p>&copy; David M. Auble | 2021</p>
    </div>

    <div class="col-xs-12 col-sm-4 col-sm-offset-4">
      <ul class="list-unstyled list-inline social-icons">
        <li>
          <a href="https://www.linkedin.com/in/dauble" target="_blank">
            <i class="fa fa-linkedin fa-2x"></i>
          </a>
        </li>
        <li>
          <a href="mailto:dauble@davidauble.info" target="_blank">
            <i class="fa fa-envelope fa-2x"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</footer>
<script type="text/javascript">
  WebFontConfig = {
    google: { families: ['Roboto&display=swap'] }
  };
  (function () {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
  })();
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="/assets/scripts/scripts.js?1614195008950277000"
  type="text/javascript"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-16309361-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'UA-16309361-1');
</script>


</body>

</html>